<Window x:Class="krrTools.Tools.Converter.ConverterWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Krrcream's AnyKeys Converter" Height="720" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Style="{DynamicResource ToolWindowStyle}">
    
    <Window.Resources>
        <!-- 浅灰主题按钮样式 -->
        <Style x:Key="LightGrayButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#212121"/>
            <Setter Property="BorderBrush" Value="#BDBDBD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center" 
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#EEEEEE"/>
                                <Setter Property="BorderBrush" Value="#2196F3"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#2196F3"/>
                                <Setter Property="BorderBrush" Value="#1976D2"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- 浅灰主题滑块样式 -->
        <Style x:Key="LightGraySliderStyle" TargetType="Slider">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Foreground" Value="#2196F3"/>
        </Style>
        
        <!-- 浅灰主题文本框样式 -->
        <Style x:Key="LightGrayTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="Foreground" Value="#212121"/>
            <Setter Property="BorderBrush" Value="#BDBDBD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="2"/>
        </Style>
        
        <!-- 浅灰主题复选框样式 -->
        <Style x:Key="LightGrayCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="#212121"/>
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#BDBDBD"/>
        </Style>
        
        <!-- 浅灰主题进度条样式 -->
        <Style x:Key="LightGrayProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#BDBDBD"/>
            <Setter Property="Foreground" Value="#2196F3"/>
        </Style>
        
        <!-- 窗口全局样式 -->
        <Style x:Key="ToolWindowStyle" TargetType="Window">
            <Setter Property="Background" Value="#EEEEEE"/>
            <Setter Property="Foreground" Value="#212121"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Border HorizontalAlignment="Center" 
                VerticalAlignment="Center"
                Width="600" Height="660"
                BorderBrush="#BDBDBD" 
                BorderThickness="2">
            <Border.Background>
                <SolidColorBrush Color="#FFFFFF" Opacity="0.5"/>
            </Border.Background>
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <!-- <TextBlock Text="拖拽.osu文件或包含.osu的文件夹到此处。"  -->
                <!--            Foreground="#212121" -->
                <!--            FontSize="28"  -->
                <!--            Margin="0,0,0,1" -->
                <!--            HorizontalAlignment="Center"/> -->
                <!-- <TextBlock Text="Drag and drop .osu files or a folder containing .osu files here."  -->
                <!--            Foreground="#212121" -->
                <!--            FontSize="14"  -->
                <!--            Margin="0,0,0,20" -->
                <!--            HorizontalAlignment="Center"/> -->
                <!-- 目标键数设置 -->
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="目标键数：" 
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="0,0,20,0"
                               FontSize="18"/>
                    <Slider x:Name="TargetKeysSlider" 
                            Grid.Column="1" 
                            Minimum="1" 
                            Maximum="18" 
                            Value="{Binding TargetKeys}"
                            TickFrequency="1" 
                            IsSnapToTickEnabled="True"
                            ValueChanged="TargetKeysSlider_ValueChanged"
                            Height="24"
                            Style="{StaticResource LightGraySliderStyle}"/>
                    <TextBlock Grid.Column="2" 
                               Text="{Binding TargetKeys, StringFormat={}{0:0}}"
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="20,0,0,0"
                               Width="40"
                               FontSize="18"/>
                </Grid>
                
                <!-- 目标键数说明 -->
                <StackPanel Margin="10,0,10,20" HorizontalAlignment="Left">
                    <TextBlock Text="你想转成几Keys就拖动到几Keys。" 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"
                               Margin="0,0,0,5"/>
                    <TextBlock Text="Target Keys, Drag to the number of keys you want to convert to." 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"/>
                </StackPanel>
                
                <!-- 最大键数设置 -->
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="最大键数：" 
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="0,0,20,0"
                               FontSize="18"/>
                    <Slider x:Name="MaxKeysSlider" 
                            Grid.Column="1" 
                            Minimum="1" 
                            Maximum="{Binding TargetKeys}"
                            Value="{Binding MaxKeys}"
                            TickFrequency="1" 
                            IsSnapToTickEnabled="True"
                            Height="24"
                            Style="{StaticResource LightGraySliderStyle}"/>
                    <TextBlock Grid.Column="2" 
                               Text="{Binding MaxKeys, StringFormat={}{0:0}}"
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="20,0,0,0"
                               Width="40"
                               FontSize="18"/>
                </Grid>
                
                <!-- 密度缩放说明 -->
                <StackPanel Margin="10,0,10,20" HorizontalAlignment="Left">
                    <TextBlock Text="密度缩放控制，最大值时为原始密度，表示每行可容纳音符数量的上限" 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"
                               Margin="0,0,0,5"/>
                    <TextBlock Text="Density scaling control. Maximum value represents original density, indicating the upper limit of notes per row" 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"/>
                </StackPanel>
                
                <!-- 最小键数设置 -->
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="最小键数：" 
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="0,0,20,0"
                               FontSize="18"/>
                    <Slider x:Name="MinKeysSlider" 
                            Grid.Column="1" 
                            Minimum="1" 
                            Maximum="{Binding MinKeysMaximum}"
                            Value="{Binding MinKeys}"
                            TickFrequency="1" 
                            IsSnapToTickEnabled="True"
                            Height="18"
                            Style="{StaticResource LightGraySliderStyle}"/>
                    <TextBlock Grid.Column="2" 
                               Text="{Binding MinKeys, StringFormat={}{0:0}}"
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="20,0,0,0"
                               Width="40"
                               FontSize="18"/>
                </Grid>

                <!-- 最小键数说明 -->
                <StackPanel Margin="10,0,10,20" HorizontalAlignment="Left">
                    <TextBlock Text="缩放密度不是最大值时生效，每行保留的最少音符数量，避免出现完全空行的情况。" 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"
                               Margin="0,0,0,5"/>
                    <TextBlock Text="Takes effect when density scaling is not at maximum.Minimum number of notes retained per row to prevent completely empty lines." 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"/>
                </StackPanel>
                
                <!-- 变换速度设置 -->
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="变换速度：" 
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="0,0,20,0"
                               FontSize="18"/>
                    <Slider x:Name="TransformSpeedSlider" 
                            Grid.Column="1" 
                            Minimum="0" 
                            Maximum="8"
                            Value="{Binding TransformSpeed}"
                            TickFrequency="1" 
                            IsSnapToTickEnabled="True"
                            Height="24"
                            Style="{StaticResource LightGraySliderStyle}"/>
                    <StackPanel Grid.Column="2" 
                                VerticalAlignment="Center" 
                                Margin="10,0,0,0"
                                Width="60">
                        <TextBlock Text="{Binding TransformSpeedDisplay}" 
                                   Foreground="#212121"
                                   FontSize="18"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>

                <!-- 变换速度说明 -->
                <StackPanel Margin="10,0,10,20" HorizontalAlignment="Left">
                    <TextBlock Text="控制变换的间隔，单位为小节。" 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"
                               Margin="0,0,0,5"/>
                    <TextBlock Text="Control the transformation interval, unit is bar." 
                               Foreground="#212121"
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"/>
                </StackPanel>
                
                <!-- 键数筛选 Keys Filter -->
                <StackPanel Margin="10,15,10,0">
                    <TextBlock Text="键数筛选：" 
                               Foreground="#212121"
                               FontSize="18" 
                               Margin="0,0,0,10"/>
                    <WrapPanel>
                        <CheckBox Content="4K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is4KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="5K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is5KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="6K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is6KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="7K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is7KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="8K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is8KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="9K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is9KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="10K" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is10KSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                        <CheckBox Content="10K+" Margin="0,0,15,5" FontSize="14" IsChecked="{Binding Is10KPlusSelected}" 
                                  Style="{StaticResource LightGrayCheckBoxStyle}"/>
                    </WrapPanel>
                </StackPanel>
                
                <!-- SEED -->
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="SEED:" 
                               Foreground="#212121"
                               VerticalAlignment="Center" 
                               Margin="0,0,10,0"
                               FontSize="18"/>
                    <TextBox x:Name="SeedTextBox" 
                             Grid.Column="1" 
                             FontSize="20"
                             VerticalContentAlignment="Center"
                             Margin="0,0,10,0"
                             Text="{Binding Seed, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource LightGrayTextBoxStyle}"/>
                    <Button x:Name="GenerateSeedButton" 
                            Grid.Column="2" 
                            Content="Generate" 
                            FontSize="20"
                            Padding="10,0"
                            Click="GenerateSeedButton_Click"
                            Style="{StaticResource LightGrayButtonStyle}"/>
                </Grid>
                
                <StackPanel Margin="10,20,10,0" HorizontalAlignment="Center">
                    <TextBlock>
                        <Hyperlink Click="PresetHyperlink_Click" Foreground="#2196F3">
                            预设 Preset
                        </Hyperlink>
                    </TextBlock>
                </StackPanel>
                
                <StackPanel Margin="10,20,10,0" Visibility="Collapsed" x:Name="ProgressPanel">
                    <ProgressBar x:Name="ConversionProgressBar" 
                                 Height="20" 
                                 Margin="0,0,0,5"
                                 Style="{StaticResource LightGrayProgressBarStyle}"/>
                    <TextBlock x:Name="ProgressTextBlock" 
                               Text="Processing files..." 
                               Foreground="#212121"
                               FontSize="14" 
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Window>
